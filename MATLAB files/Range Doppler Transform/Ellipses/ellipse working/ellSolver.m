function out = ellSolver(Qparam, Rparam)
% ellSolver

qxx = Qparam(1);
qxy = Qparam(2);
qyy = Qparam(3);
qx = Qparam(4);
qy = Qparam(5);
q0 = Qparam(6);

rxx = Rparam(1);
rxy = Rparam(2);
ryy = Rparam(3);
rx = Rparam(4);
ry = Rparam(5);
r0 = Rparam(6);

A4 = 1;
A3 = - ((qxy^3*rxx*ry - 4*qx*qyy^2*rxx^2 - 2*qx*qxx*qyy*rxy^2 + qxx*qxy*qy*rxy^2 +...
2*qxy*qy*qyy*rxx^2 + 4*qxx*qyy^2*rx*rxx - 2*qx*qxy^2*rxx*ryy + qxx*qxy^2*rx*ryy - qxx*qxy^2*rxy*ry -...
qxy^2*qy*rxx*rxy - qxy^2*qyy*rx*rxx - 2*qxx^2*qy*rxy*ryy - 4*qxx^2*qyy*rx*ryy + 4*qxx^2*qyy*rxy*ry +...
qx*qxx*qxy*rxy*ryy + 3*qx*qxy*qyy*rxx*rxy + 4*qx*qxx*qyy*rxx*ryy + 2*qxx*qxy*qy*rxx*ryy - 4*qxx*qxy*qyy*rxx*ry -...
2*qxx*qy*qyy*rxx*rxy))/(qxx^2*ryy^2 + qyy^2*rxx^2 + qxx*qyy*rxy^2 + qxy^2*rxx*ryy - qxx*qxy*rxy*ryy -...
qxy*qyy*rxx*rxy - 2*qxx*qyy*rxx*ryy);
A2 = ((qxy^4*r0*rxx + 8*q0*qxx^3*ryy^2 + 4*qxx^3*qyy*ry^2 -...
2*qx^2*qxx^2*ryy^2 + 6*qx^2*qyy^2*rxx^2 - qxx^2*qxy^2*ry^2 + 4*qxx^2*qyy^2*rx^2 + qxy^2*qy^2*rxx^2 -...
q0*qxy^3*rxx*rxy - qxx*qxy^3*r0*rxy - 8*qxx^3*qyy*r0*ryy - qx*qxy^3*rxx*ry + qxx*qxy^3*rx*ry - qxy^3*qy*rx*rxx -...
4*qxx^3*qy*ry*ryy + q0*qxx*qxy^2*rxy^2 + 4*q0*qxx^2*qyy*rxy^2 + 2*q0*qxy^2*qyy*rxx^2 - qxx*qxy^2*qyy*rx^2 +...
8*qxx^2*qyy^2*r0*rxx + 2*qxx^2*qxy^2*r0*ryy + qx^2*qxy^2*rxx*ryy + 4*qxx^2*qy^2*rxx*ryy - qx*qxx*qxy*qy*rxy^2 -...
6*qx*qxy*qy*qyy*rxx^2 + 6*q0*qxx*qxy^2*rxx*ryy - 6*qxx*qxy^2*qyy*r0*rxx - 8*q0*qxx^2*qxy*rxy*ryy +...
4*qxx^2*qxy*qyy*r0*rxy - 8*q0*qxx^2*qyy*rxx*ryy - 12*qx*qxx*qyy^2*rx*rxx - 2*qx*qxx*qxy^2*rx*ryy +...
2*qx*qxy^2*qy*rxx*rxy + 2*qx*qxy^2*qyy*rx*rxx - 2*qxx*qxy*qy^2*rxx*rxy + qx^2*qxx*qxy*rxy*ryy -...
3*qx^2*qxy*qyy*rxx*rxy + 2*qx*qxx^2*qxy*ry*ryy + 2*qx*qxx^2*qy*rxy*ryy + 4*qx*qxx^2*qyy*rx*ryy -...
4*qx*qxx^2*qyy*rxy*ry + 2*qxx^2*qxy*qy*rx*ryy + 2*qxx^2*qxy*qy*rxy*ry - 4*qxx^2*qxy*qyy*rx*ry -...
4*qxx^2*qy*qyy*rx*rxy - 4*qxx^2*qy*qyy*rxx*ry - 4*q0*qxx*qxy*qyy*rxx*rxy + 2*qx*qxx*qxy*qyy*rx*rxy -...
6*qx*qxx*qxy*qy*rxx*ryy + 6*qx*qxx*qxy*qyy*rxx*ry + 6*qx*qxx*qy*qyy*rxx*rxy +...
6*qxx*qxy*qy*qyy*rx*rxx))/(qxx^2*ryy^2 + qyy^2*rxx^2 + qxx*qyy*rxy^2 + qxy^2*rxx*ryy - qxx*qxy*rxy*ryy -...
qxy*qyy*rxx*rxy - 2*qxx*qyy*rxx*ryy);
A1 = - ((- 4*qx^3*qyy^2*rxx^2 - 8*qx*qxx^2*qyy^2*rx^2 - 2*qx*qxy^2*qy^2*rxx^2 -...
q0*qxy^4*rx*rxx + qxx*qxy^4*r0*rx + 2*q0*qxy^3*qy*rxx^2 - qxx*qxy^3*qy*rx^2 + 2*qx^3*qxx*qyy*rxy^2 +...
16*qxx^3*qyy^2*r0*rx + 8*qxx^3*qy^2*rx*ryy - 8*q0*qx*qxx^2*qyy*rxy^2 - 4*q0*qx*qxy^2*qyy*rxx^2 +...
4*q0*qxx^2*qxy*qy*rxy^2 + 2*qx*qxx*qxy^2*qyy*rx^2 - qx^2*qxx*qxy*qy*rxy^2 + 6*qx^2*qxy*qy*qyy*rxx^2 +...
4*qxx^2*qxy*qy*qyy*rx^2 - 16*qx*qxx^2*qyy^2*r0*rxx + 4*q0*qxx^2*qxy^2*rx*ryy - 4*q0*qxx^2*qxy^2*rxy*ry +...
2*qxx^2*qxy^2*qy*r0*rxy - 8*qxx^2*qxy^2*qyy*r0*rx + 2*qxx*qxy^2*qy^2*rx*rxx + 12*qx^2*qxx*qyy^2*rx*rxx +...
qx^2*qxx*qxy^2*rx*ryy + qx^2*qxx*qxy^2*rxy*ry - qx^2*qxy^2*qy*rxx*rxy - qx^2*qxy^2*qyy*rx*rxx -...
4*qxx^2*qxy*qy^2*rx*rxy + 2*qxx^2*qxy^2*qy*rx*ry - 8*qx*qxx^2*qy^2*rxx*ryy + 2*qx^2*qxx^2*qy*rxy*ryy +...
4*qx^2*qxx^2*qyy*rx*ryy - 4*qx^2*qxx^2*qyy*rxy*ry + q0*qx*qxy^3*rxx*rxy - qx*qxx*qxy^3*r0*rxy +...
4*q0*qxx*qxy^3*rxx*ry - 2*qxx*qxy^3*qy*r0*rxx - 8*q0*qxx^3*qy*rxy*ryy - 16*q0*qxx^3*qyy*rx*ryy +...
16*q0*qxx^3*qyy*rxy*ry - 8*qxx^3*qy*qyy*r0*rxy - qx*qxx*qxy^3*rx*ry + qx*qxy^3*qy*rx*rxx - qx^3*qxx*qxy*rxy*ryy +...
qx^3*qxy*qyy*rxx*rxy - 4*qx^3*qxx*qyy*rxx*ryy - 8*qxx^3*qy*qyy*rx*ry - 8*q0*qx*qxx*qxy^2*rxx*ryy -...
6*q0*qxx*qxy^2*qy*rxx*rxy + 4*q0*qxx*qxy^2*qyy*rx*rxx + 4*qx*qxx*qxy^2*qyy*r0*rxx + 4*q0*qx*qxx^2*qxy*rxy*ryy +...
4*qx*qxx^2*qxy*qyy*r0*rxy + 16*q0*qx*qxx^2*qyy*rxx*ryy + 8*q0*qxx^2*qxy*qy*rxx*ryy - 16*q0*qxx^2*qxy*qyy*rxx*ry +...
8*qxx^2*qxy*qy*qyy*r0*rxx + 2*qx*qxx*qxy^2*qy*rx*rxy + 4*qx*qxx*qxy*qy^2*rxx*rxy - 4*qx^2*qxx*qxy*qyy*rx*rxy -...
2*qx*qxx*qxy^2*qy*rxx*ry - 8*qx*qxx^2*qxy*qy*rx*ryy + 4*qx*qxx^2*qxy*qyy*rx*ry + 8*qx*qxx^2*qy*qyy*rx*rxy +...
6*qx^2*qxx*qxy*qy*rxx*ryy - 6*qx^2*qxx*qy*qyy*rxx*rxy + 8*qx*qxx^2*qy*qyy*rxx*ry + 8*q0*qx*qxx*qxy*qyy*rxx*rxy -...
12*qx*qxx*qxy*qy*qyy*rx*rxx))/(qxx^2*ryy^2 + qyy^2*rxx^2 + qxx*qyy*rxy^2 + qxy^2*rxx*ryy - qxx*qxy*rxy*ryy -...
qxy*qyy*rxx*rxy - 2*qxx*qyy*rxx*ryy);
A0 = (q0^2*qxy^4*rxx^2 + qxx^2*qxy^4*r0^2 + 16*q0^2*qxx^4*ryy^2 +...
16*qxx^4*qyy^2*r0^2 + qx^4*qxx^2*ryy^2 + qx^4*qyy^2*rxx^2 - 8*q0*qx^2*qxx^3*ryy^2 - 4*q0*qxx^3*qxy^2*ry^2 -...
8*qxx^3*qxy^2*qyy*r0^2 - 4*qx^2*qxx^3*qyy*ry^2 + 4*q0^2*qxx^2*qxy^2*rxy^2 + qx^2*qxx^2*qxy^2*ry^2 +...
4*qx^2*qxx^2*qyy^2*rx^2 + qx^2*qxy^2*qy^2*rxx^2 - q0*qxx*qxy^4*rx^2 + 16*q0*qxx^4*qyy*ry^2 - qx^4*qxx*qyy*rxy^2 +...
16*qxx^4*qy^2*r0*ryy - 2*q0*qx*qxy^3*qy*rxx^2 + qx*qxx*qxy^3*qy*rx^2 + qx^3*qxx*qxy*qy*rxy^2 -...
2*qx^3*qxy*qy*qyy*rxx^2 - 4*q0*qxx^2*qxy^3*r0*rxy + 8*q0*qxx^3*qxy^2*r0*ryy - 4*q0^2*qxx*qxy^3*rxx*rxy +...
4*q0*qxx^2*qxy^3*rx*ry - 2*qx*qxx^2*qxy^3*r0*ry - 16*qx*qxx^3*qyy^2*r0*rx - 2*qxx^2*qxy^3*qy*r0*rx -...
8*qxx^3*qxy*qy^2*r0*rxy - 16*q0^2*qxx^3*qxy*rxy*ryy + 4*qxx^3*qxy^2*qy*r0*ry + 8*qx^2*qxx^3*qyy*r0*ryy -...
4*qx^3*qxx*qyy^2*rx*rxx - 8*qx*qxx^3*qy^2*rx*ryy - 2*qx^3*qxx^2*qxy*ry*ryy - 2*qx^3*qxx^2*qy*rxy*ryy -...
4*qx^3*qxx^2*qyy*rx*ryy + 4*qx^3*qxx^2*qyy*rxy*ry + 4*qx^2*qxx^3*qy*ry*ryy - q0*qx^2*qxx*qxy^2*rxy^2 +...
4*q0*qx^2*qxx^2*qyy*rxy^2 + 2*q0*qx^2*qxy^2*qyy*rxx^2 + 4*q0*qxx^2*qxy^2*qyy*rx^2 - qx^2*qxx*qxy^2*qyy*rx^2 +...
8*qx^2*qxx^2*qyy^2*r0*rxx + 4*qxx^2*qxy^2*qy^2*r0*rxx + 2*qx^2*qxx^2*qxy^2*r0*ryy + 8*q0^2*qxx^2*qxy^2*rxx*ryy +...
4*qx^2*qxx^2*qy^2*rxx*ryy + 2*q0*qxx*qxy^4*r0*rxx - 32*q0*qxx^4*qyy*r0*ryy - 16*q0*qxx^4*qy*ry*ryy -...
16*qxx^4*qy*qyy*r0*ry + 2*qx^4*qxx*qyy*rxx*ryy + 16*q0*qxx^3*qxy*qyy*r0*rxy + 2*q0*qx*qxx*qxy^3*rx*rxy -...
2*q0*qx*qxx*qxy^3*rxx*ry + 2*q0*qxx*qxy^3*qy*rx*rxx - 2*qx*qxx*qxy^3*qy*r0*rxx + 8*q0*qx*qxx^3*qxy*ry*ryy +...
8*q0*qx*qxx^3*qy*rxy*ryy + 16*q0*qx*qxx^3*qyy*rx*ryy - 16*q0*qx*qxx^3*qyy*rxy*ry + 8*q0*qxx^3*qxy*qy*rx*ryy +...
8*q0*qxx^3*qxy*qy*rxy*ry - 16*q0*qxx^3*qxy*qyy*rx*ry - 16*qx*qxx^3*qxy*qy*r0*ryy + 8*qx*qxx^3*qxy*qyy*r0*ry +...
8*qx*qxx^3*qy*qyy*r0*rxy + 8*qxx^3*qxy*qy*qyy*r0*rx + 2*qx^3*qxx*qxy*qyy*rx*rxy - 2*qx^3*qxx*qxy*qy*rxx*ryy -...
2*qx^3*qxx*qxy*qyy*rxx*ry + 2*qx^3*qxx*qy*qyy*rxx*rxy + 8*qx*qxx^3*qy*qyy*rx*ry - 4*q0*qx*qxx^2*qxy*qy*rxy^2 -...
4*qx*qxx^2*qxy*qy*qyy*rx^2 - 8*q0*qxx^2*qxy^2*qyy*r0*rxx - 8*q0*qx*qxx^2*qxy^2*rx*ryy - 4*q0*qxx^2*qxy^2*qy*rx*rxy...
+ 6*qx*qxx^2*qxy^2*qy*r0*rxy + 4*qx*qxx^2*qxy^2*qyy*r0*rx + 2*q0*qx^2*qxx*qxy^2*rxx*ryy +...
2*qx^2*qxx*qxy^2*qyy*r0*rxx + 4*q0*qx^2*qxx^2*qxy*rxy*ryy - 8*qx^2*qxx^2*qxy*qyy*r0*rxy -...
4*q0*qxx^2*qxy^2*qy*rxx*ry - 8*q0*qx^2*qxx^2*qyy*rxx*ryy - 2*qx*qxx*qxy^2*qy^2*rx*rxx + 4*qx*qxx^2*qxy*qy^2*rx*rxy...
- 2*qx^2*qxx*qxy^2*qy*rx*rxy - 2*qx^2*qxx*qxy*qy^2*rxx*rxy - 2*qx*qxx^2*qxy^2*qy*rx*ry + 2*qx^2*qxx*qxy^2*qy*rxx*ry...
+ 6*qx^2*qxx^2*qxy*qy*rx*ryy - 2*qx^2*qxx^2*qxy*qy*rxy*ry - 4*qx^2*qxx^2*qy*qyy*rx*rxy - 4*qx^2*qxx^2*qy*qyy*rxx*ry...
+ 6*q0*qx*qxx*qxy^2*qy*rxx*rxy - 4*q0*qx*qxx*qxy^2*qyy*rx*rxx - 4*q0*qx^2*qxx*qxy*qyy*rxx*rxy -...
8*q0*qx*qxx^2*qxy*qy*rxx*ryy + 16*q0*qx*qxx^2*qxy*qyy*rxx*ry - 8*qx*qxx^2*qxy*qy*qyy*r0*rxx +...
6*qx^2*qxx*qxy*qy*qyy*rx*rxx)/(qxx^2*ryy^2 + qyy^2*rxx^2 + qxx*qyy*rxy^2 + qxy^2*rxx*ryy - qxx*qxy*rxy*ryy -...
qxy*qyy*rxx*rxy - 2*qxx*qyy*rxx*ryy);


Asol = roots([A4, A3, A2, A1, A0]);

out = Asol;

